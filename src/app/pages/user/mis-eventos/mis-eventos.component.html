<div class="mis-eventos-container">
  <div class="header">
    <h1>Mis Eventos</h1>
    <p class="subtitle">Gestiona y revisa todos tus eventos reservados</p>
  </div>

  <div class="eventos-grid" *ngIf="eventos.length > 0">
    <div class="evento-card" 
         *ngFor="let evento of eventos" 
         (click)="verDetalles(evento)"
         [class.confirmado]="evento?.stateEventType?.kind === 'Confirmado'"
         [class.proximo]="evento?.stateEventType?.kind === 'En curso'"
         [class.completado]="evento?.stateEventType?.kind === 'Completado'">
      
      <div class="card-image">
        <div class="terraza-placeholder">
          <span class="terraza-iniciales">{{ obtenerIniciales(evento.terraceModel?.name || "N?A" ) }}</span>
        </div>
        <div class="estado-badge" [style.background-color]="obtenerColorEstado(evento.stateEventType.kind)">
          {{ evento?.stateEventType?.kind || 'Sin estado' }}
        </div>
      </div>

      <div class="card-content">
        <h3 class="evento-nombre">{{ evento.terraceModel?.name || 'Terraza sin nombre' }}</h3>
        
        <div class="info-row">
          <i class="icon-calendar">üìÖ</i>
          <span>{{ formatearFecha(evento.dayDate) }}</span>
        </div>

        <div class="info-row">
          <i class="icon-user">üë§</i>
          <span>{{ evento?.clientModel?.name || 'Cliente no especificado' }}</span>
        </div>

        <div class="info-row">
          <i class="icon-location">üìç</i>
          <span>{{ evento.address || evento.terraceModel?.direction || 'Direcci√≥n no disponible' }}</span>
        </div>

        <div class="info-row">
          <i class="icon-group">üë•</i>
          <span>{{ evento.sizePeople }} personas</span>
        </div>

        <div class="info-row">
          <i class="icon-payment">üí≥</i>
          <span>{{ evento.payment || 'M√©todo no especificado' }}</span>
        </div>

        <div class="precio-total">
          <span class="precio-label">Total:</span>
          <span class="precio-valor">${{ evento.sumPrice || '0' }}</span>
        </div>

        <button class="btn-ver-detalles">
          Ver Detalles
          <i class="icon-arrow">‚û°Ô∏è</i>
        </button>
      </div>
    </div>
  </div>

  <div class="empty-state" *ngIf="eventos.length === 0">
    <div class="empty-icon">üìÖ</div>
    <h2>No tienes eventos reservados</h2>
    <p>Explora nuestras plantillas y crea tu primer evento</p>
    <a routerLink="/template" class="btn-explorar">
      Explorar Plantillas
    </a>
  </div>
</div>

<!-- Modal de Detalles del Evento -->
<div class="modal-overlay" *ngIf="mostrarModal" (click)="cerrarModal()">
  <div class="modal-content" (click)="$event.stopPropagation()" *ngIf="eventoSeleccionado">
    <button class="btn-cerrar" (click)="cerrarModal()">
      <span>&times;</span>
    </button>

    <div class="modal-header">
      <h2>{{ eventoSeleccionado.terraceModel?.name || 'Detalles del Evento' }}</h2>
      <div class="estado-badge-large" [style.background-color]="obtenerColorEstado(eventoSeleccionado.stateEventType?.kind)">
        {{ eventoSeleccionado.stateEventType?.kind || 'Sin estado' }}
      </div>
    </div>

    <div class="modal-body">
      <!-- Informaci√≥n de la Terraza -->
      <div class="seccion">
        <h3>üèõÔ∏è Terraza</h3>
        <div class="terraza-info">
          <div class="terraza-placeholder-large">
            <span class="terraza-iniciales-large">{{ obtenerIniciales(eventoSeleccionado.terraceModel?.name) }}</span>
          </div>
          <div class="terraza-detalles">
            <h4>{{ eventoSeleccionado.terraceModel?.name || 'Terraza sin nombre' }}</h4>
            <p>
              <i class="icon-marker">üìç</i>
              {{ eventoSeleccionado.address || eventoSeleccionado.terraceModel?.direction || 'Direcci√≥n no disponible' }}
            </p>
            <div class="terraza-estadisticas">
              <div class="estadistica">
                <span class="estadistica-label">Tama√±o base:</span>
                <span class="estadistica-valor">{{ eventoSeleccionado.terraceModel?.baseSize }} m¬≤</span>
              </div>
              <div class="estadistica">
                <span class="estadistica-label">Tama√±o m√°ximo:</span>
                <span class="estadistica-valor">{{ eventoSeleccionado.terraceModel?.maxSize }} m¬≤</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Informaci√≥n del Cliente -->
      <div class="seccion">
        <h3>üë§ Informaci√≥n del Cliente</h3>
        <div class="info-grid">
          <div class="info-item">
            <span class="info-label">Nombre:</span>
            <span class="info-value">{{ eventoSeleccionado.clientModel?.name || 'No especificado' }}</span>
          </div>
          <div class="info-item">
            <span class="info-label">Email:</span>
            <span class="info-value">{{ eventoSeleccionado.clientModel?.email || 'No especificado' }}</span>
          </div>
          <div class="info-item">
            <span class="info-label">Tel√©fono:</span>
            <span class="info-value">{{ eventoSeleccionado.clientModel?.phone || 'No especificado' }}</span>
          </div>
        </div>
      </div>

      <!-- Informaci√≥n del Evento -->
      <div class="seccion">
        <h3>üìã Informaci√≥n del Evento</h3>
        <div class="info-grid">
          <div class="info-item">
            <span class="info-label">ID de Reserva:</span>
            <span class="info-value">#{{ eventoSeleccionado.id || 'N/A' }}</span>
          </div>
          <div class="info-item">
            <span class="info-label">Fecha y Hora:</span>
            <span class="info-value">{{ formatearFechaCompleta(eventoSeleccionado.dayDate) }}</span>
          </div>
          <div class="info-item">
            <span class="info-label">N√∫mero de Personas:</span>
            <span class="info-value">{{ eventoSeleccionado.sizePeople }}</span>
          </div>
          <div class="info-item">
            <span class="info-label">M√©todo de Pago:</span>
            <span class="info-value">{{ eventoSeleccionado.payment || 'No especificado' }}</span>
          </div>
        </div>
      </div>

      <!-- Informaci√≥n de Precios -->
      <div class="seccion">
        <h3>üí∞ Detalles de Precios</h3>
        <div class="precios-detalle">
          <div class="precio-item">
            <span class="precio-label">Precio base terraza:</span>
            <span class="precio-valor">${{ eventoSeleccionado.terraceModel?.price?.toLocaleString('es-MX') || '0' }}</span>
          </div>
          <div class="precio-item" *ngIf="eventoSeleccionado.sizePeople > eventoSeleccionado.terraceModel?.baseSize">
            <span class="precio-label">Extensi√≥n (+{{ eventoSeleccionado.sizePeople - eventoSeleccionado.terraceModel?.baseSize }} personas):</span>
            <span class="precio-valor">+${{ eventoSeleccionado.terraceModel?.priceAdd10?.toLocaleString('es-MX') || '0' }}</span>
          </div>
        </div>
      </div>

      <!-- Total -->
      <div class="seccion total-seccion">
        <h3>üí≥ Resumen de Pago</h3>
        <div class="total-container">
          <span class="total-label">Total del Evento:</span>
          <span class="total-valor">${{ eventoSeleccionado.sumPrice?.toLocaleString('es-MX') || '0' }}</span>
        </div>
      </div>

      <!-- Acciones -->
      <div class="modal-acciones">
        <button class="btn-secundario" (click)="cerrarModal()">Cerrar</button>
        <button class="btn-primario" *ngIf="eventoSeleccionado.stateEventType?.kind === 'Confirmado' || eventoSeleccionado.stateEventType?.kind === 'En curso'">
          Contactar Soporte
        </button>
      </div>
    </div>
  </div>
</div>